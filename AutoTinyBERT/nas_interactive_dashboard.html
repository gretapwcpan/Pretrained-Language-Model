<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoTinyBERT NAS Interactive Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 30px;
            font-size: 1.2em;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        label {
            font-size: 0.9em;
            color: #4a5568;
            font-weight: 600;
        }
        
        select, input, button {
            padding: 8px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        select:hover, input:hover {
            border-color: #667eea;
        }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
        }
        
        button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: #f7fafc;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .chart-title {
            font-size: 1.2em;
            color: #2d3748;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        #paretoChart, #evolutionChart, #layerChart, #paramChart {
            width: 100%;
            height: 400px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .architecture-details {
            background: #edf2f7;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }
        
        .arch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .arch-param {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e2e8f0;
        }
        
        .arch-param-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .arch-param-label {
            font-size: 0.85em;
            color: #718096;
            margin-top: 5px;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .animation-controls {
            text-align: center;
            margin: 20px 0;
        }
        
        #playButton {
            background: #48bb78;
            padding: 10px 30px;
            font-size: 16px;
        }
        
        #playButton:hover {
            background: #38a169;
        }
        
        .info-box {
            background: #fef5e7;
            border: 2px solid #f39c12;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .info-box h3 {
            color: #e67e22;
            margin-bottom: 10px;
        }
        
        .info-box p {
            color: #7f8c8d;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🚀 AutoTinyBERT NAS Dashboard</h1>
        <div class="subtitle">Interactive Neural Architecture Search Visualization</div>
        
        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalArchs">50</div>
                <div class="stat-label">Architectures Explored</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="bestSpeedup">7.2x</div>
                <div class="stat-label">Best Speedup</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="bestAccuracy">83.3%</div>
                <div class="stat-label">Best Accuracy</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="paretoCount">8</div>
                <div class="stat-label">Pareto Optimal</div>
            </div>
        </div>
        
        <!-- Controls -->
        <div class="controls">
            <div class="control-group">
                <label>Generation</label>
                <select id="generationSelect">
                    <option value="all">All Generations</option>
                    <option value="0">Generation 0</option>
                    <option value="1">Generation 1</option>
                    <option value="2">Generation 2</option>
                    <option value="3">Generation 3</option>
                    <option value="4">Generation 4</option>
                </select>
            </div>
            <div class="control-group">
                <label>Min Accuracy (%)</label>
                <input type="range" id="minAccuracy" min="70" max="95" value="70" oninput="updateFilters()">
                <span id="minAccValue">70</span>
            </div>
            <div class="control-group">
                <label>Max Layers</label>
                <input type="range" id="maxLayers" min="1" max="8" value="8" oninput="updateFilters()">
                <span id="maxLayersValue">8</span>
            </div>
            <button onclick="resetFilters()">Reset Filters</button>
            <button id="playButton" onclick="playAnimation()">▶ Play Evolution</button>
        </div>
        
        <!-- Info Box -->
        <div class="info-box">
            <h3>💡 How to Use This Dashboard</h3>
            <p>
                • <strong>Pareto Frontier:</strong> Shows the trade-off between speedup and accuracy. Points on the red line are optimal.
                <br>• <strong>Hover over points:</strong> See detailed architecture configurations.
                <br>• <strong>Use filters:</strong> Focus on specific generations or performance ranges.
                <br>• <strong>Play Evolution:</strong> Watch how the search progresses over generations.
            </p>
        </div>
        
        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <div class="chart-container">
                <div class="chart-title">Pareto Frontier: Accuracy vs Speedup</div>
                <div id="paretoChart"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">Search Evolution</div>
                <div id="evolutionChart"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">Layer Distribution</div>
                <div id="layerChart"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">Parameter Efficiency</div>
                <div id="paramChart"></div>
            </div>
        </div>
        
        <!-- Selected Architecture Details -->
        <div class="architecture-details">
            <h2>Selected Architecture Details</h2>
            <div class="arch-grid" id="archDetails">
                <div class="arch-param">
                    <div class="arch-param-value" id="selectedLayers">4</div>
                    <div class="arch-param-label">Layers</div>
                </div>
                <div class="arch-param">
                    <div class="arch-param-value" id="selectedHidden">384</div>
                    <div class="arch-param-label">Hidden Size</div>
                </div>
                <div class="arch-param">
                    <div class="arch-param-value" id="selectedHeads">6</div>
                    <div class="arch-param-label">Attention Heads</div>
                </div>
                <div class="arch-param">
                    <div class="arch-param-value" id="selectedFFN">1536</div>
                    <div class="arch-param-label">FFN Size</div>
                </div>
                <div class="arch-param">
                    <div class="arch-param-value" id="selectedParams">5.9M</div>
                    <div class="arch-param-label">Parameters</div>
                </div>
                <div class="arch-param">
                    <div class="arch-param-value" id="selectedSpeedup">7.2x</div>
                    <div class="arch-param-label">Speedup</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Generate sample data
        function generateSampleData(n = 50) {
            const architectures = [];
            for (let i = 0; i < n; i++) {
                const layerNum = Math.floor(Math.random() * 8) + 1;
                const hiddenSize = [128, 256, 384, 512, 640, 768][Math.floor(Math.random() * 6)];
                const numHeads = [1, 2, 4, 6, 8, 12][Math.floor(Math.random() * 6)];
                const ffnSize = [512, 1024, 1536, 2048, 3072][Math.floor(Math.random() * 5)];
                
                const sizeFactor = (layerNum * hiddenSize) / (8 * 768);
                const speedup = 100 / (10 + sizeFactor * 90 + (Math.random() - 0.5) * 10);
                const accuracy = 70 + sizeFactor * 25 + (Math.random() - 0.5) * 6;
                const params = (layerNum * hiddenSize * 4) / 1e6;
                
                architectures.push({
                    id: `arch_${i}`,
                    generation: Math.floor(i / 10),
                    layerNum,
                    hiddenSize,
                    numHeads,
                    ffnSize,
                    speedup,
                    accuracy,
                    params,
                    glueScore: accuracy - Math.random() * 5,
                    squadScore: accuracy + (Math.random() - 0.5) * 6
                });
            }
            return architectures;
        }
        
        let allData = generateSampleData();
        let filteredData = [...allData];
        let selectedArch = allData[0];
        
        // Find Pareto optimal points
        function findParetoOptimal(data) {
            const pareto = [];
            for (let i = 0; i < data.length; i++) {
                let isPareto = true;
                for (let j = 0; j < data.length; j++) {
                    if (i !== j && 
                        data[j].speedup >= data[i].speedup && 
                        data[j].accuracy >= data[i].accuracy &&
                        (data[j].speedup > data[i].speedup || data[j].accuracy > data[i].accuracy)) {
                        isPareto = false;
                        break;
                    }
                }
                if (isPareto) pareto.push(data[i]);
            }
            return pareto;
        }
        
        // Update Pareto chart
        function updateParetoChart() {
            const paretoPoints = findParetoOptimal(filteredData);
            
            // Sort pareto points by speedup for line drawing
            paretoPoints.sort((a, b) => a.speedup - b.speedup);
            
            // Update stats
            document.getElementById('paretoCount').textContent = paretoPoints.length;
            
            // All architectures scatter
            const trace1 = {
                x: filteredData.map(d => d.speedup),
                y: filteredData.map(d => d.accuracy),
                mode: 'markers',
                type: 'scatter',
                name: 'All Architectures',
                marker: {
                    size: filteredData.map(d => d.params * 2),
                    color: filteredData.map(d => d.generation),
                    colorscale: 'Viridis',
                    showscale: true,
                    colorbar: {
                        title: 'Generation',
                        thickness: 15,
                        len: 0.5
                    }
                },
                text: filteredData.map(d => 
                    `ID: ${d.id}<br>` +
                    `Layers: ${d.layerNum}<br>` +
                    `Hidden: ${d.hiddenSize}<br>` +
                    `Heads: ${d.numHeads}<br>` +
                    `FFN: ${d.ffnSize}<br>` +
                    `Params: ${d.params.toFixed(1)}M`
                ),
                hovertemplate: '%{text}<br>Speedup: %{x:.1f}x<br>Accuracy: %{y:.1f}%'
            };
            
            // Pareto frontier line
            const trace2 = {
                x: paretoPoints.map(d => d.speedup),
                y: paretoPoints.map(d => d.accuracy),
                mode: 'lines+markers',
                type: 'scatter',
                name: 'Pareto Frontier',
                line: {
                    color: 'red',
                    width: 2,
                    dash: 'dash'
                },
                marker: {
                    size: 10,
                    color: 'red'
                }
            };
            
            const layout = {
                xaxis: { title: 'Speedup (x)' },
                yaxis: { title: 'Accuracy (%)' },
                hovermode: 'closest',
                showlegend: true,
                height: 400
            };
            
            Plotly.newPlot('paretoChart', [trace1, trace2], layout);
            
            // Add click handler
            document.getElementById('paretoChart').on('plotly_click', function(data) {
                const point = data.points[0];
                const arch = filteredData[point.pointIndex];
                updateSelectedArchitecture(arch);
            });
        }
        
        // Update evolution chart
        function updateEvolutionChart() {
            const generations = [...new Set(filteredData.map(d => d.generation))].sort();
            const meanAccuracy = [];
            const maxAccuracy = [];
            const meanSpeedup = [];
            
            generations.forEach(gen => {
                const genData = filteredData.filter(d => d.generation === gen);
                meanAccuracy.push(genData.reduce((sum, d) => sum + d.accuracy, 0) / genData.length);
                maxAccuracy.push(Math.max(...genData.map(d => d.accuracy)));
                meanSpeedup.push(genData.reduce((sum, d) => sum + d.speedup, 0) / genData.length);
            });
            
            const trace1 = {
                x: generations,
                y: meanAccuracy,
                mode: 'lines+markers',
                name: 'Mean Accuracy',
                line: { color: 'blue' }
            };
            
            const trace2 = {
                x: generations,
                y: maxAccuracy,
                mode: 'lines+markers',
                name: 'Best Accuracy',
                line: { color: 'green' }
            };
            
            const layout = {
                xaxis: { title: 'Generation' },
                yaxis: { title: 'Accuracy (%)' },
                height: 400
            };
            
            Plotly.newPlot('evolutionChart', [trace1, trace2], layout);
        }
        
        // Update layer distribution chart
        function updateLayerChart() {
            const layerCounts = {};
            for (let i = 1; i <= 8; i++) {
                layerCounts[i] = filteredData.filter(d => d.layerNum === i).length;
            }
            
            const trace = {
                x: Object.keys(layerCounts),
                y: Object.values(layerCounts),
                type: 'bar',
                marker: { color: '#667eea' }
            };
            
            const layout = {
                xaxis: { title: 'Number of Layers' },
                yaxis: { title: 'Count' },
                height: 400
            };
            
            Plotly.newPlot('layerChart', [trace], layout);
        }
        
        // Update parameter efficiency chart
        function updateParamChart() {
            const trace = {
                x: filteredData.map(d => d.params),
                y: filteredData.map(d => d.accuracy),
                mode: 'markers',
                type: 'scatter',
                marker: {
                    size: 8,
                    color: filteredData.map(d => d.speedup),
                    colorscale: 'RdYlGn',
                    showscale: true,
                    colorbar: {
                        title: 'Speedup',
                        thickness: 15,
                        len: 0.5
                    }
                },
                text: filteredData.map(d => `Speedup: ${d.speedup.toFixed(1)}x`),
                hovertemplate: 'Params: %{x:.1f}M<br>Accuracy: %{y:.1f}%<br>%{text}'
            };
            
            const layout = {
                xaxis: { title: 'Parameters (M)' },
                yaxis: { title: 'Accuracy (%)' },
                height: 400
            };
            
            Plotly.newPlot('paramChart', [trace], layout);
        }
        
        // Update selected architecture details
        function updateSelectedArchitecture(arch) {
            selectedArch = arch;
            document.getElementById('selectedLayers').textContent = arch.layerNum;
            document.getElementById('selectedHidden').textContent = arch.hiddenSize;
            document.getElementById('selectedHeads').textContent = arch.numHeads;
            document.getElementById('selectedFFN').textContent = arch.ffnSize;
            document.getElementById('selectedParams').textContent = arch.params.toFixed(1) + 'M';
            document.getElementById('selectedSpeedup').textContent = arch.speedup.toFixed(1) + 'x';
        }
        
        // Update filters
        function updateFilters() {
            const minAcc = parseFloat(document.getElementById('minAccuracy').value);
            const maxLay = parseInt(document.getElementById('maxLayers').value);
            const genSelect = document.getElementById('generationSelect').value;
            
            document.getElementById('minAccValue').textContent = minAcc;
            document.getElementById('maxLayersValue').textContent = maxLay;
            
            filteredData = allData.filter(d => {
                let pass = d.accuracy >= minAcc && d.layerNum <= maxLay;
                if (genSelect !== 'all') {
                    pass = pass && d.generation === parseInt(genSelect);
                }
                return pass;
            });
            
            updateAllCharts();
            updateStats();
        }
        
        // Reset filters
        function resetFilters() {
            document.getElementById('minAccuracy').value = 70;
            document.getElementById('maxLayers').value = 8;
            document.getElementById('generationSelect').value = 'all';
            updateFilters();
        }
        
        // Update statistics
        function updateStats() {
            document.getElementById('totalArchs').textContent = filteredData.length;
            
            if (filteredData.length > 0) {
                const maxSpeedup = Math.max(...filteredData.map(d => d.speedup));
                const maxAccuracy = Math.max(...filteredData.map(d => d.accuracy));
                document.getElementById('bestSpeedup').textContent = maxSpeedup.toFixed(1) + 'x';
                document.getElementById('bestAccuracy').textContent = maxAccuracy.toFixed(1) + '%';
            }
        }
        
        // Update all charts
        function updateAllCharts() {
            updateParetoChart();
            updateEvolutionChart();
            updateLayerChart();
            updateParamChart();
        }
        
        // Play animation
        let animationInterval;
        function playAnimation() {
            const button = document.getElementById('playButton');
            if (button.textContent.includes('Play')) {
                button.textContent = '⏸ Pause';
                let currentGen = 0;
                animationInterval = setInterval(() => {
                    document.getElementById('generationSelect').value = currentGen.toString();
                    updateFilters();
                    currentGen++;
                    if (currentGen > 4) {
                        currentGen = 0;
                        setTimeout(() => {
                            document.getElementById('generationSelect').value = 'all';
                            updateFilters();
                        }, 1000);
                    }
                }, 2000);
            } else {
                button.textContent = '▶ Play Evolution';
                clearInterval(animationInterval);
            }
        }
        
        // Event listeners
        document.getElementById('generationSelect').addEventListener('change', updateFilters);
        
        // Initialize dashboard
        window.onload = function() {
            updateAllCharts();
            updateStats();
            updateSelectedArchitecture(selectedArch);
        };
    </script>
</body>
</html>
